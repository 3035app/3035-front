<app-header></app-header>
<main class="container pia-mainContainer pia-mainContainerBlock">
    <div class="row">
        <!-- Left sidebar (sections) -->
        <div class="small-12 medium-3 columns">
            <aside class="pia-leftSidebar">
                <div class="processing-sections">
                    <div class="processing-section-header">
                        <h1 class="truncate" title="{{processing.name}}">{{ processing.name }}</h1>
                        <a class="pia-icons pia-icon-close-big" routerLink="/folders/{{ processing.folder.id }}"
                            title="{{ 'processing.sections.homepage_link' | translate }}"></a>
                    </div>

                    <div class="processing-section-body">
                        <div id="context-section">
                            <div class="processing-section-title">
                                {{ 'sections.1.title' | translate }}
                                <hr>
                            </div>
                            <ul class="processing-section-list">
                                <ng-container *ngFor="let section of sections; let i=index">
                                    <li *ngIf="i < 2">
                                        <a (click)="changeSection(section.id)"
                                            [ngClass]="{'active': currentSection.id == section.id}" class="truncate">
                                            {{ section.title | translate }}</a>
                                        <!-- <i class="fa"
                                            *ngIf="_sidStatusService.sidStatusIcon[_sidStatusService.itemStatus[dataSection.id + '.' + dataItem.id]]"
                                            [ngClass]="_sidStatusService.sidStatusIcon[_sidStatusService.itemStatus[dataSection.id + '.' + dataItem.id]]"
                                            aria-hidden="true"></i> -->
                                    </li>
                                </ng-container>
                            </ul>
                        </div>
                        <div id="principles-section">
                            <div class="processing-section-title">
                                {{ 'sections.2.title' | translate }}
                                <hr>
                            </div>
                            <ul class="processing-section-list">
                                <ng-container *ngFor="let section of sections; let i=index">
                                    <li *ngIf="i > 1">
                                        <a (click)="changeSection(section.id)"
                                            [ngClass]="{'active': currentSection.id == section.id}" class="truncate">
                                            {{ section.title | translate }}</a>
                                    </li>
                                </ng-container>
                            </ul>
                        </div>
                    </div>
                </div>
                <app-sections [section]="section" [item]="item"></app-sections>
                <app-processing-attachments [processing]="processing"></app-processing-attachments>
            </aside>
        </div>

        <!-- Main form content -->
        <div class="small-12 medium-6 columns">
            <app-processing-form [processing]="processing" [sections]="sections" [currentSection]="currentSection"></app-processing-form>

            <div class="processing-bottom-nav">
                <a *ngIf="currentSection.id > 1" class="processing-previous" (click)="changeSection(currentSection.id - 1)">
                    <i class="fa fa-angle-double-left" aria-hidden="true"></i>
                    {{ 'processing.form.previous' | translate }}
                </a>
                <a *ngIf="currentSection.id < 4" class="processing-next" (click)="changeSection(currentSection.id + 1)">
                    {{ 'processing.form.next' | translate }}
                    <i class="fa fa-angle-double-right" aria-hidden="true"></i>
                </a>
                <span *ngIf="currentSection.id == 4 && processing.pias_count == 0" >
                    <a class="processing-next" (click)="createPia()" *ngxPermissionsOnly="['CanCreatePIA']">
                        {{ 'processing.form.pia_section.new_pia_button' | translate }}
                        <i class="fa fa-angle-double-right" aria-hidden="true"></i>
                    </a>
                </span>
                <span *ngIf="currentSection.id == 4 && processing.pias_count > 0">
                    <a class="processing-next" routerLink="/entry/{{pias[0].id}}/section/3/item/1">
                        {{ 'processing.pia-list.item.actions.edit' | translate }}
                        <i class="fa fa-angle-double-right" aria-hidden="true"></i>
                    </a>
                </span>
            </div>
        </div>

        <!-- Right sidebar (knowledge base) -->
        <div class="small-12 medium-3 columns">
            <div class="pia-rightSidebar">
                <app-knowledge-base [item]=""></app-knowledge-base>
            </div>
        </div>
    </div>
</main>

<app-modals></app-modals>
